{"Caption":"Figure 7: Algorithm to create the directory structure in Figure 6. ","ImageText":[{"Text":"procedure","TextBB":[442.2,106.874,502.292,119.328],"Rotation":0},{"Text":"make","TextBB":[505.817,106.874,537.906,119.328],"Rotation":0},{"Text":"maze(exit","TextBB":[542.906,106.874,597.868,119.328],"Rotation":0},{"Text":"target,","TextBB":[602.856,106.874,638.68,119.328],"Rotation":0},{"Text":"nchains,","TextBB":[642.142,106.874,688.367,119.328],"Rotation":0},{"Text":"depth)","TextBB":[691.854,106.874,727.153,119.328],"Rotation":0},{"Text":"link","TextBB":[461.888,123.487,484.94,135.94],"Rotation":0},{"Text":"exit","TextBB":[488.403,124.234,521.556,135.11],"Rotation":0},{"Text":"to","TextBB":[525.031,123.487,536.544,135.94],"Rotation":0},{"Text":"exit","TextBB":[540.006,123.487,559.684,135.94],"Rotation":0},{"Text":"target","TextBB":[564.658,123.487,597.023,135.94],"Rotation":0},{"Text":"let","TextBB":[461.887,140.087,476.471,152.54],"Rotation":0},{"Text":"top","TextBB":[479.934,140.087,497.59,152.54],"Rotation":0},{"Text":"=","TextBB":[501.052,134.344,508.843,153.426],"Rotation":0},{"Text":"current","TextBB":[512.305,140.087,556.541,152.54],"Rotation":0},{"Text":"directory()","TextBB":[560.028,140.087,623.456,152.54],"Rotation":0},{"Text":"let","TextBB":[461.887,156.687,476.471,169.14],"Rotation":0},{"Text":"target","TextBB":[479.934,156.687,512.299,169.14],"Rotation":0},{"Text":"=","TextBB":[515.761,150.944,523.552,170.026],"Rotation":0},{"Text":"top\/exit","TextBB":[527.014,156.687,586.112,169.14],"Rotation":0},{"Text":"for","TextBB":[461.887,173.299,479.179,185.753],"Rotation":0},{"Text":"i","TextBB":[482.654,172.372,487.414,186.209],"Rotation":0},{"Text":"=","TextBB":[491.264,173.382,502.016,183.898],"Rotation":0},{"Text":"0","TextBB":[505.853,173.382,512.758,183.898],"Rotation":0},{"Text":"to","TextBB":[516.22,173.299,527.733,185.753],"Rotation":0},{"Text":"nchains","TextBB":[531.195,173.299,573.96,185.753],"Rotation":0},{"Text":"-","TextBB":[577.448,173.299,582.055,185.753],"Rotation":0},{"Text":"1","TextBB":[585.505,173.299,592.41,185.753],"Rotation":0},{"Text":"mkdir","TextBB":[482.675,189.899,519.523,202.353],"Rotation":0},{"Text":"chaini","TextBB":[522.998,190.647,569.199,201.522],"Rotation":0},{"Text":"cd","TextBB":[482.675,206.499,496.484,218.953],"Rotation":0},{"Text":"chaini","TextBB":[499.946,207.247,546.148,218.122],"Rotation":0},{"Text":"for","TextBB":[482.675,223.112,499.967,235.565],"Rotation":0},{"Text":"j","TextBB":[503.429,222.185,509.116,236.022],"Rotation":0},{"Text":"=","TextBB":[513.754,223.195,524.505,233.711],"Rotation":0},{"Text":"0","TextBB":[528.355,223.195,535.26,233.711],"Rotation":0},{"Text":"to","TextBB":[538.722,223.112,550.235,235.565],"Rotation":0},{"Text":"depth","TextBB":[553.697,223.112,584.388,235.565],"Rotation":0},{"Text":"mkdir","TextBB":[503.45,239.712,540.298,252.165],"Rotation":0},{"Text":"d","TextBB":[543.773,240.459,552.061,251.335],"Rotation":0},{"Text":"cd","TextBB":[503.45,256.312,517.259,268.765],"Rotation":0},{"Text":"d","TextBB":[520.734,257.059,529.022,267.935],"Rotation":0},{"Text":"link","TextBB":[482.675,272.924,505.727,285.378],"Rotation":0},{"Text":"lnk","TextBB":[509.19,273.672,534.055,284.547],"Rotation":0},{"Text":"to","TextBB":[537.517,272.924,549.029,285.378],"Rotation":0},{"Text":"target","TextBB":[552.492,272.924,584.857,285.378],"Rotation":0},{"Text":"let","TextBB":[482.674,289.524,497.259,301.978],"Rotation":0},{"Text":"target","TextBB":[500.709,289.524,533.074,301.978],"Rotation":0},{"Text":"=","TextBB":[536.549,283.782,544.339,302.863],"Rotation":0},{"Text":"current","TextBB":[547.801,289.524,592.037,301.978],"Rotation":0},{"Text":"directory()","TextBB":[595.525,289.524,658.953,301.978],"Rotation":0},{"Text":"cd","TextBB":[482.674,306.124,496.484,318.578],"Rotation":0},{"Text":"top","TextBB":[499.946,306.124,517.602,318.578],"Rotation":0},{"Text":"link","TextBB":[461.887,322.737,484.939,335.19],"Rotation":0},{"Text":"sentry","TextBB":[488.402,323.484,538.132,334.36],"Rotation":0},{"Text":"to","TextBB":[541.607,322.737,553.119,335.19],"Rotation":0},{"Text":"target","TextBB":[556.582,322.737,588.947,335.19],"Rotation":0}],"Mention":["This technique can be extended to create a maze of up\nto C chains, chainC \u0000 1, chainC \u0000 2, ..., chain0,\nwhere each chain has at its bottom a symbolic link point-\ning to the bottom of the next chain. Figure 6 shows one\nsuch maze of directories in its entirety. For simplicity,\nwe create a \u0002nal link, exit, pointing to the target \u0002le, at\nthen end of the maze. We also use shorter names for the\ndirectories in each chain, enabling us to create deeper\nchains within the constraints of MAXPATHLEN. Pseu-\ndocode for constructing this maze is given in Figure 7.\nWith this structure, the attacker runs the victim with the\n\u0002lename argument activedir\/sentry\/lnk\/...\/\nlnk\/lnk.\n"],"Page":6,"Number":7,"Type":"Figure","CaptionBB":[436,349,750,387],"Height":1100,"Width":850,"DPI":100,"ImageBB":[436,99,735,344]}