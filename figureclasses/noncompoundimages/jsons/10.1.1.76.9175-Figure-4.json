{"Caption":"Figure 4: Adapting latches for use under TLS execu- tion. ","ImageText":[{"Text":"✂","TextBB":[184.868,96.7689,184.868,96.8856],"Rotation":0},{"Text":" ","TextBB":[285.829,96.7689,285.829,96.8856],"Rotation":0},{"Text":"✂","TextBB":[184.868,109.692,184.868,109.809],"Rotation":0},{"Text":"✄","TextBB":[184.868,109.871,184.868,109.988],"Rotation":0},{"Text":"✂","TextBB":[184.868,122.615,184.868,122.732],"Rotation":0},{"Text":"✄","TextBB":[184.868,122.794,184.868,122.911],"Rotation":0},{"Text":"✂","TextBB":[184.868,135.538,184.868,135.655],"Rotation":0},{"Text":"✄","TextBB":[184.868,135.717,184.868,135.834],"Rotation":0},{"Text":"Acquire","TextBB":[196.984,102.545,228.309,115.911],"Rotation":0},{"Text":"...work...","TextBB":[196.984,114.661,231.546,128.026],"Rotation":0},{"Text":"Release","TextBB":[196.984,126.776,227.078,140.142],"Rotation":0},{"Text":"✁","TextBB":[285.829,96.9484,285.829,97.0651],"Rotation":0},{"Text":"Violation!","TextBB":[237.799,96.9777,277.111,110.527],"Rotation":0},{"Text":"Acquire","TextBB":[297.945,102.545,329.27,115.911],"Rotation":0},{"Text":" ","TextBB":[285.829,109.692,285.829,109.809],"Rotation":0},{"Text":"✁","TextBB":[285.829,109.871,285.829,109.988],"Rotation":0},{"Text":" ","TextBB":[285.829,122.615,285.829,122.732],"Rotation":0},{"Text":"✁","TextBB":[285.829,122.794,285.829,122.911],"Rotation":0},{"Text":" ","TextBB":[285.829,135.538,285.829,135.655],"Rotation":0},{"Text":"✁","TextBB":[285.829,135.717,285.829,135.834],"Rotation":0},{"Text":"{","TextBB":[94.6111,166.137,166.338,372.202],"Rotation":0},{"Text":"✄","TextBB":[184.868,96.9484,184.868,97.0651],"Rotation":0},{"Text":"(a)","TextBB":[151.593,170.041,166.625,179.871],"Rotation":0},{"Text":"Latch","TextBB":[170.544,170.041,199.778,179.871],"Rotation":0},{"Text":"operations","TextBB":[203.697,170.041,257.03,179.871],"Rotation":0},{"Text":"create","TextBB":[260.948,170.041,291.666,179.871],"Rotation":0},{"Text":"dependences.","TextBB":[295.584,170.041,362.632,179.871],"Rotation":0},{"Text":"✂","TextBB":[244.041,199.399,244.041,199.513],"Rotation":0},{"Text":"☎","TextBB":[334.486,199.399,334.486,199.513],"Rotation":0},{"Text":"✄","TextBB":[244.041,199.574,244.041,199.688],"Rotation":0},{"Text":"✆","TextBB":[334.486,199.574,334.486,199.688],"Rotation":0},{"Text":" ","TextBB":[153.597,211.983,153.597,212.096],"Rotation":0},{"Text":"✂","TextBB":[244.041,211.983,244.041,212.096],"Rotation":0},{"Text":"☎","TextBB":[334.486,211.983,334.486,212.096],"Rotation":0},{"Text":"✁","TextBB":[153.597,212.158,153.597,212.271],"Rotation":0},{"Text":"✄","TextBB":[244.041,212.158,244.041,212.271],"Rotation":0},{"Text":"✆","TextBB":[334.486,212.158,334.486,212.271],"Rotation":0},{"Text":" ","TextBB":[153.597,237.15,153.597,237.264],"Rotation":0},{"Text":"✁","TextBB":[153.597,237.325,153.597,237.438],"Rotation":0},{"Text":" ","TextBB":[153.597,249.734,153.597,249.847],"Rotation":0},{"Text":"✁","TextBB":[153.597,249.908,153.597,250.022],"Rotation":0},{"Text":" ","TextBB":[153.597,262.317,153.597,262.431],"Rotation":0},{"Text":"✁","TextBB":[153.597,262.492,153.597,262.606],"Rotation":0},{"Text":"latch_cnt++","TextBB":[255.838,221.54,301.083,234.554],"Rotation":0},{"Text":"...work...","TextBB":[255.838,233.337,289.493,246.352],"Rotation":0},{"Text":"(enqueue","TextBB":[255.838,245.134,290.428,258.149],"Rotation":0},{"Text":"release)","TextBB":[292.787,245.134,322.233,258.149],"Rotation":0},{"Text":"✂","TextBB":[244.041,224.566,244.041,224.68],"Rotation":0},{"Text":"✄","TextBB":[244.041,224.741,244.041,224.855],"Rotation":0},{"Text":"✂","TextBB":[244.041,237.15,244.041,237.264],"Rotation":0},{"Text":"✄","TextBB":[244.041,237.325,244.041,237.438],"Rotation":0},{"Text":"✂","TextBB":[244.041,249.734,244.041,249.847],"Rotation":0},{"Text":"✄","TextBB":[244.041,249.908,244.041,250.022],"Rotation":0},{"Text":"latch_cnt++","TextBB":[346.283,221.54,391.527,234.554],"Rotation":0},{"Text":"...work...","TextBB":[346.283,233.337,379.938,246.352],"Rotation":0},{"Text":"(enqueue","TextBB":[346.283,245.134,380.872,258.149],"Rotation":0},{"Text":"release)","TextBB":[383.232,245.134,412.677,258.149],"Rotation":0},{"Text":"☎","TextBB":[334.486,224.566,334.486,224.68],"Rotation":0},{"Text":"✆","TextBB":[334.486,224.741,334.486,224.855],"Rotation":0},{"Text":"☎","TextBB":[334.486,237.15,334.486,237.264],"Rotation":0},{"Text":"✆","TextBB":[334.486,237.325,334.486,237.438],"Rotation":0},{"Text":"☎","TextBB":[334.486,249.734,334.486,249.847],"Rotation":0},{"Text":"✆","TextBB":[334.486,249.908,334.486,250.022],"Rotation":0},{"Text":"✂","TextBB":[244.041,262.317,244.041,262.431],"Rotation":0},{"Text":"☎","TextBB":[334.486,262.317,334.486,262.431],"Rotation":0},{"Text":"✄","TextBB":[244.041,262.492,244.041,262.606],"Rotation":0},{"Text":"✆","TextBB":[334.486,262.492,334.486,262.606],"Rotation":0},{"Text":" ","TextBB":[153.597,274.901,153.597,275.014],"Rotation":0},{"Text":"✂","TextBB":[244.041,274.901,244.041,275.014],"Rotation":0},{"Text":"☎","TextBB":[334.486,274.901,334.486,275.014],"Rotation":0},{"Text":"✁","TextBB":[153.597,275.076,153.597,275.189],"Rotation":0},{"Text":"✄","TextBB":[244.041,275.076,244.041,275.189],"Rotation":0},{"Text":"✆","TextBB":[334.486,275.076,334.486,275.189],"Rotation":0},{"Text":"✂","TextBB":[244.041,287.484,244.041,287.598],"Rotation":0},{"Text":"☎","TextBB":[334.486,287.484,334.486,287.598],"Rotation":0},{"Text":"✄","TextBB":[244.041,287.659,244.041,287.773],"Rotation":0},{"Text":"✆","TextBB":[334.486,287.659,334.486,287.773],"Rotation":0},{"Text":"oldest","TextBB":[181.071,287.95,203.532,302.56],"Rotation":0},{"Text":"✂","TextBB":[244.041,300.068,244.041,300.182],"Rotation":0},{"Text":"✄","TextBB":[244.041,300.243,244.041,300.356],"Rotation":0},{"Text":"✂","TextBB":[244.041,312.652,244.041,312.765],"Rotation":0},{"Text":"✄","TextBB":[244.041,312.826,244.041,312.94],"Rotation":0},{"Text":"Commit","TextBB":[255.838,292.323,286.785,305.337],"Rotation":0},{"Text":"work","TextBB":[289.144,292.323,308.642,305.337],"Rotation":0},{"Text":"latch_cnt−−","TextBB":[255.838,304.12,301.083,317.134],"Rotation":0},{"Text":"☎","TextBB":[334.486,325.235,334.486,325.349],"Rotation":0},{"Text":"✆","TextBB":[334.486,325.41,334.486,325.524],"Rotation":0},{"Text":"☎","TextBB":[334.486,337.819,334.486,337.932],"Rotation":0},{"Text":"✆","TextBB":[334.486,337.994,334.486,338.107],"Rotation":0},{"Text":"☎","TextBB":[334.486,350.402,334.486,350.516],"Rotation":0},{"Text":"✆","TextBB":[334.486,350.577,334.486,350.691],"Rotation":0},{"Text":"Commit","TextBB":[346.283,323.782,377.229,336.796],"Rotation":0},{"Text":"work","TextBB":[379.589,323.782,399.087,336.796],"Rotation":0},{"Text":"latch_cnt−−","TextBB":[346.283,335.579,391.527,348.593],"Rotation":0},{"Text":"Release","TextBB":[346.283,347.376,375.587,360.39],"Rotation":0},{"Text":"✂","TextBB":[130.854,424.043,130.854,424.162],"Rotation":0},{"Text":" ","TextBB":[225.686,424.043,225.686,424.162],"Rotation":0},{"Text":"☎","TextBB":[320.518,424.043,320.518,424.162],"Rotation":0},{"Text":"✁","TextBB":[225.686,424.226,225.686,424.345],"Rotation":0},{"Text":"✆","TextBB":[320.518,424.226,320.518,424.345],"Rotation":0},{"Text":" ","TextBB":[225.686,437.237,225.686,437.356],"Rotation":0},{"Text":"☎","TextBB":[320.518,437.237,320.518,437.356],"Rotation":0},{"Text":"✁","TextBB":[225.686,437.42,225.686,437.539],"Rotation":0},{"Text":"✆","TextBB":[320.518,437.42,320.518,437.539],"Rotation":0},{"Text":"Small","TextBB":[99.373,550.474,113.019,573.57],"Rotation":3},{"Text":"critical","TextBB":[99.373,520.411,113.019,548],"Rotation":3},{"Text":"sections","TextBB":[99.373,486.054,113.019,517.937],"Rotation":3},{"Text":"{","TextBB":[114.361,438.397,130.194,483.884],"Rotation":0},{"Text":"✂","TextBB":[130.854,437.237,130.854,437.356],"Rotation":0},{"Text":"✄","TextBB":[130.854,437.42,130.854,437.539],"Rotation":0},{"Text":"{","TextBB":[114.361,512.614,130.194,558.1],"Rotation":0},{"Text":"{","TextBB":[114.361,562.091,130.194,607.577],"Rotation":0},{"Text":"Acquire","TextBB":[143.223,447.257,175.206,460.903],"Rotation":0},{"Text":"...work...","TextBB":[143.223,459.627,178.511,473.272],"Rotation":0},{"Text":"Release","TextBB":[143.223,471.996,173.949,485.642],"Rotation":0},{"Text":"✂","TextBB":[130.854,463.625,130.854,463.744],"Rotation":0},{"Text":"✄","TextBB":[130.854,477.002,130.854,477.121],"Rotation":0},{"Text":"✂","TextBB":[130.854,476.819,130.854,476.938],"Rotation":0},{"Text":"✄","TextBB":[130.854,463.808,130.854,463.927],"Rotation":0},{"Text":"(enqueue","TextBB":[238.055,447.257,274.322,460.903],"Rotation":0},{"Text":"acquire)","TextBB":[276.796,447.257,309.323,460.903],"Rotation":0},{"Text":"...work...","TextBB":[238.055,459.627,273.342,473.272],"Rotation":0},{"Text":"(enqueue","TextBB":[238.055,471.996,274.322,485.642],"Rotation":0},{"Text":"release)","TextBB":[276.796,471.996,307.67,485.642],"Rotation":0},{"Text":" ","TextBB":[225.686,450.431,225.686,450.55],"Rotation":0},{"Text":"✁","TextBB":[225.686,477.002,225.686,477.121],"Rotation":0},{"Text":" ","TextBB":[225.686,476.819,225.686,476.938],"Rotation":0},{"Text":"✁","TextBB":[225.686,463.808,225.686,463.927],"Rotation":0},{"Text":" ","TextBB":[225.686,463.625,225.686,463.744],"Rotation":0},{"Text":"✁","TextBB":[225.686,450.614,225.686,450.733],"Rotation":0},{"Text":"☎","TextBB":[320.518,463.625,320.518,463.744],"Rotation":0},{"Text":"✂","TextBB":[130.854,490.013,130.854,490.132],"Rotation":0},{"Text":" ","TextBB":[225.686,490.013,225.686,490.132],"Rotation":0},{"Text":"☎","TextBB":[320.518,490.013,320.518,490.132],"Rotation":0},{"Text":"✄","TextBB":[130.854,490.196,130.854,490.315],"Rotation":0},{"Text":"✁","TextBB":[225.686,490.196,225.686,490.315],"Rotation":0},{"Text":"✆","TextBB":[320.518,490.196,320.518,490.315],"Rotation":0},{"Text":"✆","TextBB":[320.518,477.002,320.518,477.121],"Rotation":0},{"Text":"☎","TextBB":[320.518,476.819,320.518,476.938],"Rotation":0},{"Text":"✆","TextBB":[320.518,463.808,320.518,463.927],"Rotation":0},{"Text":"✂","TextBB":[130.854,503.207,130.854,503.326],"Rotation":0},{"Text":" ","TextBB":[225.686,503.207,225.686,503.326],"Rotation":0},{"Text":"☎","TextBB":[320.518,503.207,320.518,503.326],"Rotation":0},{"Text":"✄","TextBB":[130.854,503.39,130.854,503.509],"Rotation":0},{"Text":"✁","TextBB":[225.686,503.39,225.686,503.509],"Rotation":0},{"Text":"✆","TextBB":[320.518,503.39,320.518,503.509],"Rotation":0},{"Text":" ","TextBB":[225.686,516.401,225.686,516.52],"Rotation":0},{"Text":"☎","TextBB":[320.518,516.401,320.518,516.52],"Rotation":0},{"Text":"✁","TextBB":[225.686,516.584,225.686,516.703],"Rotation":0},{"Text":"✆","TextBB":[320.518,516.584,320.518,516.703],"Rotation":0},{"Text":"oldest","TextBB":[159.661,516.889,183.211,532.208],"Rotation":0},{"Text":" ","TextBB":[225.686,529.595,225.686,529.714],"Rotation":0},{"Text":"✁","TextBB":[225.686,556.166,225.686,556.285],"Rotation":0},{"Text":" ","TextBB":[225.686,555.983,225.686,556.102],"Rotation":0},{"Text":"✁","TextBB":[225.686,542.972,225.686,543.091],"Rotation":0},{"Text":" ","TextBB":[225.686,542.789,225.686,542.908],"Rotation":0},{"Text":"✁","TextBB":[225.686,529.778,225.686,529.897],"Rotation":0},{"Text":"Acquire","TextBB":[238.055,521.473,270.037,535.119],"Rotation":0},{"Text":"Commit","TextBB":[238.055,533.843,270.502,547.489],"Rotation":0},{"Text":"work","TextBB":[272.976,533.843,293.42,547.489],"Rotation":0},{"Text":"Release","TextBB":[238.055,546.212,268.781,559.858],"Rotation":0},{"Text":"☎","TextBB":[320.518,542.789,320.518,542.908],"Rotation":0},{"Text":"✆","TextBB":[320.518,542.972,320.518,543.091],"Rotation":0},{"Text":"☎","TextBB":[320.518,555.983,320.518,556.102],"Rotation":0},{"Text":"✆","TextBB":[320.518,556.166,320.518,556.285],"Rotation":0},{"Text":"☎","TextBB":[320.518,569.177,320.518,569.296],"Rotation":0},{"Text":"✆","TextBB":[320.518,569.36,320.518,569.479],"Rotation":0},{"Text":"☎","TextBB":[320.518,582.371,320.518,582.49],"Rotation":0},{"Text":"☎","TextBB":[320.518,595.565,320.518,595.684],"Rotation":0},{"Text":"☎","TextBB":[320.518,608.759,320.518,608.878],"Rotation":0},{"Text":"✆","TextBB":[320.518,595.748,320.518,595.867],"Rotation":0},{"Text":"✆","TextBB":[320.518,608.942,320.518,609.061],"Rotation":0},{"Text":"☎","TextBB":[320.518,529.595,320.518,529.714],"Rotation":0},{"Text":"✆","TextBB":[320.518,582.554,320.518,582.673],"Rotation":0},{"Text":"✆","TextBB":[320.518,529.778,320.518,529.897],"Rotation":0},{"Text":"oldest","TextBB":[254.493,562.243,278.043,577.562],"Rotation":0},{"Text":"(enqueue","TextBB":[332.887,447.257,369.154,460.903],"Rotation":0},{"Text":"acquire)","TextBB":[371.628,447.257,404.154,460.903],"Rotation":0},{"Text":"...work...","TextBB":[332.887,459.627,368.174,473.272],"Rotation":0},{"Text":"(enqueue","TextBB":[332.887,471.996,369.154,485.642],"Rotation":0},{"Text":"release)","TextBB":[371.628,471.996,402.502,485.642],"Rotation":0},{"Text":"☎","TextBB":[320.518,450.431,320.518,450.55],"Rotation":0},{"Text":"✆","TextBB":[320.518,450.614,320.518,450.733],"Rotation":0},{"Text":"☎","TextBB":[334.486,312.652,334.486,312.765],"Rotation":0},{"Text":"☎","TextBB":[334.486,300.068,334.486,300.182],"Rotation":0},{"Text":"✆","TextBB":[334.486,312.826,334.486,312.94],"Rotation":0},{"Text":"✆","TextBB":[334.486,300.243,334.486,300.356],"Rotation":0},{"Text":"✄","TextBB":[130.854,424.226,130.854,424.345],"Rotation":0},{"Text":"✂","TextBB":[130.854,450.431,130.854,450.55],"Rotation":0},{"Text":"(b)","TextBB":[103.836,384.94,119.522,394.77],"Rotation":0},{"Text":"Aggressive","TextBB":[123.916,384.94,177.946,394.77],"Rotation":0},{"Text":"latch","TextBB":[182.352,384.94,207.501,394.77],"Rotation":0},{"Text":"acquire.","TextBB":[211.907,384.94,252.1,394.77],"Rotation":0},{"Text":"The","TextBB":[258.764,384.94,279.021,394.77],"Rotation":0},{"Text":"long","TextBB":[283.416,384.94,304.979,394.77],"Rotation":0},{"Text":"critical","TextBB":[309.385,384.94,344.674,394.77],"Rotation":0},{"Text":"section","TextBB":[349.08,384.94,384.424,394.77],"Rotation":0},{"Text":"that","TextBB":[388.819,384.94,410.382,394.77],"Rotation":0},{"Text":"results","TextBB":[103.836,397.428,137.299,407.257],"Rotation":0},{"Text":"may","TextBB":[141.218,397.428,162.792,407.257],"Rotation":0},{"Text":"cause","TextBB":[166.711,397.428,194.207,407.257],"Rotation":0},{"Text":"performance","TextBB":[198.137,397.428,261.531,407.257],"Rotation":0},{"Text":"issues.","TextBB":[265.461,397.428,297.673,407.257],"Rotation":0},{"Text":"✄","TextBB":[130.854,450.614,130.854,450.733],"Rotation":0},{"Text":"oldest","TextBB":[271.515,319.409,293.976,334.019],"Rotation":0},{"Text":"Acquire","TextBB":[165.394,221.54,195.897,234.554],"Rotation":0},{"Text":"latch_cnt++","TextBB":[165.394,233.337,210.638,246.352],"Rotation":0},{"Text":"...work...","TextBB":[165.394,245.134,199.049,258.149],"Rotation":0},{"Text":"latch_cnt−−","TextBB":[165.394,256.931,210.638,269.946],"Rotation":0},{"Text":" ","TextBB":[153.597,224.566,153.597,224.68],"Rotation":0},{"Text":"✁","TextBB":[153.597,224.741,153.597,224.855],"Rotation":0},{"Text":"Large","TextBB":[96.0456,308.099,109.06,330.212],"Rotation":3},{"Text":"critical","TextBB":[96.0456,279.428,109.06,305.74],"Rotation":3},{"Text":"section","TextBB":[96.0456,250.331,109.06,277.068],"Rotation":3},{"Text":" ","TextBB":[153.597,199.399,153.597,199.513],"Rotation":0},{"Text":"✁","TextBB":[153.597,199.574,153.597,199.688],"Rotation":0},{"Text":"Acquire","TextBB":[332.887,570.951,364.869,584.597],"Rotation":0},{"Text":"Commit","TextBB":[332.887,583.32,365.334,596.966],"Rotation":0},{"Text":"work","TextBB":[367.808,583.32,388.252,596.966],"Rotation":0},{"Text":"Release","TextBB":[332.887,595.69,363.613,609.336],"Rotation":0},{"Text":"(c)","TextBB":[103.836,627.161,118.204,636.991],"Rotation":0},{"Text":"Lazy","TextBB":[123.994,627.161,148.656,636.991],"Rotation":0},{"Text":"latch","TextBB":[154.423,627.161,179.584,636.991],"Rotation":0},{"Text":"acquire.","TextBB":[185.363,627.161,225.556,636.991],"Rotation":0},{"Text":"Delaying","TextBB":[236.36,627.161,281.268,636.991],"Rotation":0},{"Text":"the","TextBB":[287.046,627.161,303.385,636.991],"Rotation":0},{"Text":"acquire","TextBB":[309.163,627.161,346.091,636.991],"Rotation":0},{"Text":"shrinks","TextBB":[351.869,627.161,388.277,636.991],"Rotation":0},{"Text":"the","TextBB":[394.055,627.161,410.382,636.991],"Rotation":0},{"Text":"critical","TextBB":[103.836,639.648,139.126,649.478],"Rotation":0},{"Text":"section.","TextBB":[143.055,639.648,181.665,649.478],"Rotation":0}],"Mention":["The database system uses latches extensively to pro-\ntect data structures, and as a building block for locks.\nLatches are required for correct execution when multi-\nple transactions are executing concurrently, and ensure\nthat only one thread is accessing a given shared data\nstructure at any time. Latches are typically held only\nbriefly\u2014in Section 4.1.2 we discuss locks, which offer\nconcurrency control for database entities.\nLatches form a dependence between epochs because\nof how they are implemented: a typical implemen-\ntation uses a read-test-write cycle on a memory lo-\ncation (which may be implemented as a test-and-set,\nload-linked\/store-conditional, atomic increment, etc.).\nThis read-test-write cycle can cause a data dependence\nviolation between epochs (Figure 4(a)).\nUnder TLS, using latches to serialize accesses within\na transaction is completely unnecessary\u2014the TLS\nmechanism already ensures that any data protected by\nthe latch is accessed in a serializable order, namely the\noriginal sequential program order. Hence using latches\nto preserve mutual exclusion between epochs is redun-\ndant with the existing TLS mechanism [8]. However,\nlatches do ensure that mutual exclusion is maintained\nbetween transactions, and TLS does not perform that\nfunction. So we cannot simply discard the latches; we\nmust instead ensure that they preserve mutual exclu-\nsion between transactions without causing violations\n","speculatively at the point when it is encountered. This\ncan be implemented by a recursive latch, which counts\nthe number of acquires and releases, and makes the\nlatch available to other transactions only when the\ncount reaches zero. This aggressive approach, shown\nin Figure 4(b), has a major drawback: since latch re-\nleases have been delayed until the end of the epoch, we\nhave increased the overall size of the critical section. In\naddition, since we have parallel overlap between mul-\ntiple critical sections in a single transaction, the latch\nmay be held for an extended period of time.\n","To avoid long critical sections, we can also post-\npone acquires as shown in Figure 4(c). In this lazy\napproach, all latch acquires are performed at the end\nof the epoch, then the buffered speculative modifica-\ntions are committed, and finally all latch releases are\nperformed. This method results in much smaller criti-\ncal sections, even when acquire and release operations\nfor a given latch are encountered repeatedly during\nan epoch. A potential disadvantage of this approach\nis that if another transaction changes the protected\ndata, the epoch will violate and restart.\n"],"Page":6,"Number":4,"Type":"Figure","CaptionBB":[88,674,415,704],"Height":1100,"Width":850,"DPI":100,"ImageBB":[88,95,417,664]}